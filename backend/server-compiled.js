(()=>{var e={860:e=>{"use strict";e.exports=require("express")},13:e=>{"use strict";e.exports=require("mongodb")},109:e=>{"use strict";e.exports=require("sanitize-html")}},t={};function s(a){var o=t[a];if(void 0!==o)return o.exports;var n=t[a]={exports:{}};return e[a](n,n.exports,s),n.exports}(()=>{const{MongoClient:e,ObjectId:t}=s(13),a=s(860),o=s(109);let n;const i=a();i.set("view engine","ejs"),i.set("views","./views"),i.use(a.static("../public")),i.use(a.json()),i.use(a.urlencoded({extended:!1})),i.get("/",(async(e,t)=>{const s=await n.collection("Tasks").find().toArray();console.log(s),t.render("home",{allTasks:s})})),i.get("/admin",((e,t)=>{t.render("admin")})),i.get("/api/tasks",(async(e,t)=>{const s=await n.collection("Tasks").find().toArray();t.json(s)})),i.post("/create-task",((e,t,s)=>{e.cleanData={name:o(e.body.name.trim(),{allowedTags:[],allowedAttributes:{}}),description:o(e.body.description.trim(),{allowedTags:[],allowedAttributes:{}}),status:o(e.body.status.trim(),{allowedTags:[],allowedAttributes:{}})},s()}),(async(e,s)=>{console.log(e.body);const a=await n.collection("Tasks").insertOne(e.cleanData),o=await n.collection("Tasks").findOne({_id:new t(a.insertId)});s.send(o)})),i.delete("/task/:id",(async(e,s)=>{"string"!=typeof e.params.id&&(e.params.id=""),n.collection("Tasks").deleteOne({_id:new t(e.params.id)}),s.send("Item Deleted")})),async function(){const t=new e("mongodb://root:root@localhost:27017/Kanban-App?&authSource=admin");await t.connect(),n=t.db(),i.listen(3e3)}()})()})();